import streamlit as st
import pandas as pd
import time
import random

# ุชูุธูุงุช ุตูุญู (ูุฎุตูุต ููุจุงู ฺฉู ุงุฏููโูุง ุฑุงุญุช ุจุงุดู)
st.set_page_config(page_title="ูุฏุฑุช ุณูุงุฑุดุงุช ุขููุงู", page_icon="๐๏ธ", layout="centered")

# --- ุงุณุชุงู ุฏู ุจุฑุง ุฒุจุง (ุชู ุงูุณุชุงฺฏุฑุงู) ---
st.markdown("""
    <style>
    .big-font { font-size:20px !important; color: #E1306C; font-weight: bold; }
    .success-msg { padding:10px; border-radius:10px; background-color:#d4edda; color:#155724; }
    </style>
    """, unsafe_allow_html=True)

# --- ูุฏุฑ ---
st.title("๐๏ธ ุฏุณุชุงุฑ ููุดููุฏ ุขููุงูโุดุงูพ")
st.write("ูุฏุฑุช ููุฌูุฏ ู ุตุฏูุฑ ูุงฺฉุชูุฑ ุฏุฑ ณ ุซุงูู!")

# --- ุฏุชุงุจุณ ูุฑุถ ูุญุตููุงุช (ฺฉู ุงุฏูู ูุงุฑุฏ ฺฉุฑุฏู) ---
if 'products' not in st.session_state:
    st.session_state.products = pd.DataFrame({
        'ูุงู ูุญุตูู': ['ูุงูุชู ฺฉุช ูุงุฒุฑุงุช', 'ุดููุงุฑ ุฌู ูุงู ุงุณุชุงู', 'ุดุงู ูุฎ ูพูุณู', 'ฺฉูุด ุฌุฑุฏู ุณุงูโุฏุงุฑ'],
        'ููุช (ุชููุงู)': [580000, 450000, 120000, 1200000],
        'ููุฌูุฏ': [5, 12, 0, 3],
        'ฺฉุฏ ูุญุตูู': [101, 102, 103, 104]
    })

# --- ุชุจโูุง ุจุฑุง ูุธู ---
tab1, tab2, tab3 = st.tabs(["๐ ุตุฏูุฑ ูุงฺฉุชูุฑ", "๐ฆ ููุฌูุฏ ุงูุจุงุฑ", "๐ฐ ุฎุฑุฏ ุงุดุชุฑุงฺฉ"])

with tab1:
    st.subheader("ุณุงุฎุช ูุงฺฉุชูุฑ ุณุฑุน ุจุฑุง ุฏุงุฑฺฉุช")
    
    # ุงูุชุฎุงุจ ูุญุตูู
    product_list = st.session_state.products['ูุงู ูุญุตูู'].tolist()
    selected_product = st.selectbox("ูุดุชุฑ ฺ ูุฎูุงุฏุ", product_list)
    
    # ูพุฏุง ฺฉุฑุฏู ุงุทูุงุนุงุช ูุญุตูู
    row = st.session_state.products[st.session_state.products['ูุงู ูุญุตูู'] == selected_product].iloc[0]
    
    col1, col2 = st.columns(2)
    with col1:
        st.metric("ููุช", f"{row['ููุช (ุชููุงู)']:,} ุชููุงู")
    with col2:
        if row['ููุฌูุฏ'] > 0:
            st.metric("ููุฌูุฏ", f"{row['ููุฌูุฏ']} ุนุฏุฏ", delta="ููุฌูุฏ โ")
        else:
            st.metric("ููุฌูุฏ", "0", delta="ูุงููุฌูุฏ โ", delta_color="inverse")

    customer_name = st.text_input("ูุงู ูุดุชุฑ (ุงุฎุชุงุฑ):")
    
    if st.button("๐ ุงุฌุงุฏ ูุชู ูุงฺฉุชูุฑ (ฺฉูพ ฺฉู)"):
        if row['ููุฌูุฏ'] > 0:
            st.balloons()
            factor_text = f"""
            ุณูุงู {customer_name} ุนุฒุฒ ๐ธ
            ุณูุงุฑุด ุดูุง ุซุจุช ุดุฏ:
            ๐๏ธ {row['ูุงู ูุญุตูู']}
            ๐ฐ ููุช: {row['ููุช (ุชููุงู)']:,.0f} ุชููุงู
            ๐ฆ ูุฒูู ูพุณุช: ณฐ,ฐฐฐ ุชููุงู
            ------------------
            ๐ณ ูุจูุบ ฺฉู: {row['ููุช (ุชููุงู)'] + 30000:,.0f} ุชููุงู
            ุดูุงุฑู ฺฉุงุฑุช: ถฐณท-นนทฑ-ฐฐฐฐ-ฐฐฐฐ (ุจู ูุงู ูุฑูุดฺฏุงู)
            ูุทูุงู ูุด ูุงุฑุฒ ุฑุง ุงุฑุณุงู ฺฉูุฏ. ๐
            """
            st.text_area("ูุชู ุขูุงุฏู ุงุฑุณุงู (ฺฉูพ ฺฉูุฏ):", factor_text, height=250)
            st.success("ูุชู ฺฉูพ ุดุฏ! ุจูุฑุณุช ุชู ุฏุงุฑฺฉุช.")
        else:
            st.error("โ ุงู ูุญุตูู ููุฌูุฏ ูุณุช! ุดุฑููุฏู ูุดุชุฑ ูุด.")

with tab2:
    st.subheader("ูุถุนุช ุงูุจุงุฑ")
    # ูุงุจูุช ูุฑุงุด ูุณุชูู ุฌุฏูู (ุฎู ฺฉุงุฑุจุฑุฏ)
    edited_df = st.data_editor(st.session_state.products, num_rows="dynamic")
    st.session_state.products = edited_df

with tab3:
    st.warning("๐ ุงู ูุณุฎู ุฏูู ุงุณุช.")
    st.write("ุจุฑุง ุงุณุชูุงุฏู ูุงูุญุฏูุฏ ู ุงุชุตุงู ุจู ุฏุฑฺฏุงู ูพุฑุฏุงุฎุชุ ุงุดุชุฑุงฺฉ ุชูู ฺฉูุฏ.")
    st.markdown("### ูุงูุงูู ููุท ดนฐ,ฐฐฐ ุชููุงู")
    if st.button("๐ณ ุฎุฑุฏ ุขููุงู ู ูุนุงูโุณุงุฒ ุขู"):
        st.info("ุฏุฑ ุญุงู ุงูุชูุงู ุจู ุฏุฑฺฏุงู ูพุฑุฏุงุฎุช ุฒุฑูโูพุงู...")
        # ุงูุฌุง ุจุนุฏุงู ููฺฉ ูพุฑุฏุงุฎุช ูุงูุน ุฑู ูุฐุงุฑู